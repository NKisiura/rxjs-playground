import{a as se}from"./chunk-LINETVEA.js";import{$ as U,A as v,Db as oe,H as G,Hb as ae,Ib as fe,L as k,La as q,M as F,Na as T,Q as P,Qa as K,Ra as V,S as D,Sa as H,T as $,Ta as X,Ua as s,Va as i,Wa as Y,a as R,ba as z,cb as p,db as J,eb as g,f as B,fb as Z,gb as A,hb as Q,ib as ee,j as E,jb as te,kb as re,nb as d,ob as m,r as c,x as M,y as C,za as n}from"./chunk-ARPSXJKY.js";var Ge=typeof global=="object"&&global&&global.Object===Object&&global,ie=Ge;var ke=typeof self=="object"&&self&&self.Object===Object&&self,Fe=ie||ke||Function("return this")(),ne=Fe;var Pe=ne.Symbol,x=Pe;var pe=Object.prototype,De=pe.hasOwnProperty,$e=pe.toString,b=x?x.toStringTag:void 0;function Ue(e){var t=De.call(e,b),r=e[b];try{e[b]=void 0;var o=!0}catch{}var a=$e.call(e);return o&&(t?e[b]=r:delete e[b]),a}var le=Ue;var ze=Object.prototype,qe=ze.toString;function Ke(e){return qe.call(e)}var de=Ke;var Ve="[object Null]",He="[object Undefined]",me=x?x.toStringTag:void 0;function Xe(e){return e==null?e===void 0?He:Ve:me&&me in Object(e)?le(e):de(e)}var S=Xe;function Ye(e){return e!=null&&typeof e=="object"}var ue=Ye;var Je="[object Symbol]";function Ze(e){return typeof e=="symbol"||ue(e)&&S(e)==Je}var xe=Ze;var Qe=/\s/;function et(e){for(var t=e.length;t--&&Qe.test(e.charAt(t)););return t}var ce=et;var tt=/^\s+/;function rt(e){return e&&e.slice(0,ce(e)+1).replace(tt,"")}var be=rt;function ot(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var u=ot;var he=NaN,at=/^[-+]0x[0-9a-f]+$/i,ft=/^0b[01]+$/i,st=/^0o[0-7]+$/i,it=parseInt;function nt(e){if(typeof e=="number")return e;if(xe(e))return he;if(u(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=u(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=be(e);var r=ft.test(e);return r||st.test(e)?it(e.slice(2),r?2:8):at.test(e)?he:+e}var ye=nt;var Ee=1/0,pt=17976931348623157e292;function lt(e){if(!e)return e===0?e:0;if(e=ye(e),e===Ee||e===-Ee){var t=e<0?-1:1;return t*pt}return e===e?e:0}var h=lt;function dt(e){var t=h(e),r=t%1;return t===t?r?t-r:t:0}var ge=dt;var mt="[object AsyncFunction]",ut="[object Function]",xt="[object GeneratorFunction]",ct="[object Proxy]";function bt(e){if(!u(e))return!1;var t=S(e);return t==ut||t==xt||t==mt||t==ct}var Se=bt;var ht=9007199254740991,yt=/^(?:0|[1-9]\d*)$/;function Et(e,t){var r=typeof e;return t=t??ht,!!t&&(r=="number"||r!="symbol"&&yt.test(e))&&e>-1&&e%1==0&&e<t}var Ie=Et;function gt(e,t){return e===t||e!==e&&t!==t}var Le=gt;var St=9007199254740991;function It(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=St}var ve=It;function Lt(e){return e!=null&&ve(e.length)&&!Se(e)}var Te=Lt;function vt(e,t,r){if(!u(r))return!1;var o=typeof t;return(o=="number"?Te(r)&&Ie(t,r.length):o=="string"&&t in r)?Le(r[t],e):!1}var Ae=vt;function Tt(e,t,r){var o=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var f=Array(a);++o<a;)f[o]=e[o+t];return f}var _e=Tt;function At(e,t,r){var o=e==null?0:e.length;return o?(t=r||t===void 0?1:ge(t),t=o-t,_e(e,0,t<0?0:t)):[]}var _=At;var _t=Math.floor,Ot=Math.random;function wt(e,t){return e+_t(Ot()*(t-e+1))}var Oe=wt;var Nt=parseFloat,Wt=Math.min,jt=Math.random;function Rt(e,t,r){if(r&&typeof r!="boolean"&&Ae(e,t,r)&&(t=r=void 0),r===void 0&&(typeof t=="boolean"?(r=t,t=void 0):typeof e=="boolean"&&(r=e,e=void 0)),e===void 0&&t===void 0?(e=0,t=1):(e=h(e),t===void 0?(t=e,e=0):t=h(t)),e>t){var o=e;e=t,t=o}if(r||e%1||t%1){var a=jt();return Wt(e+a*(t-e+Nt("1e-"+((a+"").length-1))),t)}return Oe(e,t)}var O=Rt;var I={width:200,height:360},we=15,Ne=20,We=150,w=1e3,N="BEST_SCORE",je={score:0,level:1,letters:[]};var Re=()=>String.fromCharCode(Math.floor(Math.random()*26)+97),Be=()=>O(I.width-14),Me=e=>/^[a-zA-Z]$/.test(e);var Bt=()=>[],Mt=(e,t)=>({width:e,height:t}),Ct=e=>({left:e});function Gt(e,t){if(e&1&&(s(0,"div",5),d(1,"px"),p(2),i()),e&2){let r=t.$implicit;T("ngStyle",te(4,Ct,m(1,2,r.xPosition))),n(2),g(" ",r.letter," ")}}function kt(e,t){if(e&1&&(s(0,"div",7)(1,"span",8),p(2),i(),s(3,"span"),p(4," Press "),s(5,"span",9),p(6," Space "),i(),p(7),i()()),e&2){let r=t;n(2),J(r.title),n(5),g(" to ",r.message," ")}}var Ce=class e{DOCUMENT=U(oe);GAME_FIELD=I;infoWindowSubject=new E(null);infoWindow$=this.infoWindowSubject.asObservable();bestScoreSubject=new E(Number(localStorage.getItem(N))||0);bestScore$=this.bestScoreSubject.asObservable();game$=new B;intervalSubject=new E(w);ticker$=this.intervalSubject.pipe(P(t=>C(t)));keydownEvent$=M(this.DOCUMENT,"keydown");letterInput$=this.keydownEvent$.pipe(c(({key:t})=>t),v(Me));letterActions$=this.ticker$.pipe(c(()=>({action:0,payload:{letter:Re(),xPosition:Be()}})),k(this.letterInput$.pipe(c(t=>({action:1,payload:{key:t}})))));ngOnInit(){this.prepareNewGame({title:"WELCOME!",message:"start the game!"})}startGame(){this.game$=this.letterActions$.pipe(F(({letters:t,level:r,score:o},{action:a,payload:f})=>{switch(a){case 0:return{letters:[R({},f),...t],level:r,score:o};case 1:{let{key:y}=f;if(!(t.at(-1)?.letter===y))return{letters:t,level:r,score:o};let l=o+1,j=l/Ne>=r;return l>this.bestScoreSubject.getValue()&&(this.bestScoreSubject.next(l),localStorage.setItem(N,l.toString())),j&&this.intervalSubject.next(this.intervalSubject.getValue()-We),{letters:_(t),level:j?r+1:r,score:l}}}},je),D(({letters:t})=>t.length<=we),G(()=>{this.intervalSubject.next(w),this.prepareNewGame({title:"GAME OVER!",message:"try again!"})}))}prepareNewGame(t){this.showInfoWindow(t),this.setupStartGameListener()}showInfoWindow(t){this.infoWindowSubject.next(t)}closeInfoWindow(){this.infoWindowSubject.next(null)}setupStartGameListener(){let t=this.keydownEvent$.pipe(c(({key:r})=>r),v(r=>r===" "),$(()=>{this.closeInfoWindow(),this.startGame(),t.unsubscribe()})).subscribe()}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=z({type:e,selectors:[["app-alphabet-invasion"]],standalone:!0,features:[Q],decls:22,vars:19,consts:[[1,"relative","flex","flex-col","items-center"],[1,""],[1,"border","border-gray-300"],[1,"flex",3,"ngStyle"],[1,"absolute"],[1,"relative",3,"ngStyle"],[1,"h-px","w-full","self-end","border-b","border-dashed","border-red-500"],[1,"absolute","left-1/2","top-1/4","z-10","flex","-translate-x-1/2","flex-col","items-center","gap-4","rounded-lg","bg-pink-700","p-4","text-white","shadow-xl","shadow-black/25"],[1,"text-2xl"],[1,"rounded-md","border","border-b-2","border-gray-400","bg-white","px-2","py-0.5","text-gray-400"]],template:function(r,o){if(r&1&&(s(0,"div",0),A(1),d(2,"async"),A(3)(4)(5)(6),d(7,"async"),s(8,"div"),p(9),i(),s(10,"div",1),p(11),i(),s(12,"div",2)(13,"div",3),d(14,"px"),d(15,"px"),s(16,"div",4),H(17,Gt,3,6,"div",5,V),i(),Y(19,"div",6),i()(),q(20,kt,8,2,"div",7),d(21,"async"),i()),r&2){let a,f=m(2,5,o.game$),y=(f==null?null:f.score)||0,L=(f==null?null:f.level)||1,W=(f==null?null:f.letters)||ee(15,Bt),l=m(7,7,o.bestScore$);n(9),g("BEST SCORE: ",l,""),n(2),Z("Level: ",L," Score: ",y,""),n(2),T("ngStyle",re(16,Mt,m(14,9,o.GAME_FIELD.width),m(15,11,o.GAME_FIELD.height))),n(4),X(W),n(3),K((a=m(21,13,o.infoWindow$))?20:-1,a)}},dependencies:[ae,se,fe],changeDetection:0})};export{Ce as AlphabetInvasionComponent};
